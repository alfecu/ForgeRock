/*!
 * Copyright 2019-2020 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4534466e"],{"20f7":function(e,t,i){"use strict";var s=i("ca3e"),a=i.n(s);a.a},"3fd4":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.providers.length?i("div",[e._l(e.filteredProviders,(function(t,s){return i("button",{key:s,staticClass:"btn btn-lg btn-light btn-block fr-btn-social mb-3",style:e.socialButtonStyles[s],attrs:{type:"button"},on:{click:function(i){return e.goToIDP(t.provider)},mouseover:function(i){return e.hover(s,t.uiConfig.buttonCustomStyleHover)},mouseout:function(i){return e.hover(s,t.uiConfig.buttonCustomStyle)}}},[t.uiConfig.buttonImage?i("img",{attrs:{src:"static/"+t.uiConfig.buttonImage}}):i("i",{class:["fab fa-lg",t.uiConfig.iconClass]}),e.signin?i("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("pages.selfservice.social.signIn"))+" "+e._s(t.uiConfig.buttonDisplayName))]):i("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("pages.selfservice.social.signUp"))+" "+e._s(t.uiConfig.buttonDisplayName))])])})),0===this.filterProviders.length?i("div",{staticClass:"fr-form-break text-muted mb-3"},[i("div"),i("div",[e._v(e._s(e.$t("pages.selfservice.social.or")))]),i("div")]):e._e()],2):e._e()},a=[],n=i("2ef0"),r=i.n(n),o={name:"Social-Buttons",props:{signin:{type:Boolean,default:!1},filterProviders:{type:Array,default:function(){return[]}},filterProvidersObjects:{type:Array,default:function(){return[]}}},computed:{filteredProviders:function(){return r.a.filter(this.providers,(function(e){return e.uiConfig}))}},data:function(){return{providers:[],socialButtonStyles:[]}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this,t=this.getRequestService({headers:this.getAnonymousHeaders()});t.get("/authentication").then((function(t){e.providers=r.a.filter(t.data.providers||[],(function(t,i){if(0===e.filterProviders.length||r.a.includes(e.filterProviders,t.provider))return!0})),e.providers.length?r.a.each(e.providers,(function(t,i){e.$set(e.socialButtonStyles,i,t.uiConfig.buttonCustomStyle),"salesforce"===t.provider&&(t.uiConfig.iconClass="fa-salesforce")})):e.filterProvidersObjects.length&&(e.providers=e.filterProvidersObjects)})).catch((function(t){e.displayNotification("error",t.response.data.message)}))},hover:function(e,t){this.$set(this.socialButtonStyles,e,t)},goToIDP:function(e){var t=this,i=this.getRequestService({headers:this.getAnonymousHeaders()});i.post("/authentication?_action=logout").then((function(){i.post("/identityProviders?_action=getAuthRedirect",{provider:e,landingPage:"".concat(window.location.protocol,"/").concat(window.location.host,"/#/login?_oauthReturn=true&provider=").concat(e,"&gotoURL=%23")}).then((function(e){localStorage.setItem("dataStoreToken",e.data.token),window.location.href=e.data.redirect})).catch((function(e){t.displayNotification("error",e.response.data.message)}))})).catch((function(e){t.displayNotification("error",e.response.data.message)}))}}},l=o,c=(i("f970"),i("2877")),u=Object(c["a"])(l,s,a,!1,null,"0852992a",null);t["a"]=u.exports},"5aa8":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mb-4",attrs:{id:"captchaBody"}},[e.apiType?i("p",{staticClass:"text-center mb-4"},[e._v(" "+e._s(e.$t("pages.selfservice.headers."+e.apiType+".description"))+" ")]):e._e(),e._m(0)])},a=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"recaptcha-wrapper "},[i("div",{staticClass:"recaptcha-bound"},[i("div",{attrs:{id:"recaptchaContainer"}})])])}],n=i("2ef0"),r=i.n(n),o={name:"Captcha",props:{advanceStage:{required:!1},selfServiceDetails:{required:!0},apiType:{required:!1}},created:function(){var e=document.createElement("script");e.setAttribute("src","https://www.google.com/recaptcha/api.js"),document.head.appendChild(e)},mounted:function(){this.loadRecaptcha()},methods:{loadRecaptcha:function(){var e=this;r.a.isUndefined(this.selfServiceDetails.requirements.properties.response.recaptchaSiteKey)||0===this.selfServiceDetails.requirements.properties.response.recaptchaSiteKey.length?this.displayNotification("error",this.$t("pages.selfservice.captchaError")):setTimeout((function(){"undefined"===typeof window.grecaptcha?e.loadRecaptcha():window.grecaptcha.render("recaptchaContainer",{sitekey:e.selfServiceDetails.requirements.properties.response.recaptchaSiteKey,callback:e.handleCaptchaCallback})}),500)},handleCaptchaCallback:function(e){this.recaptchaResponse=e,this.$listeners.advanceStage&&this.$emit("advanceStage",this.getData())},getData:function(){return{response:this.recaptchaResponse,"g-recaptcha-response":this.recaptchaResponse}}}},l=o,c=i("2877"),u=Object(c["a"])(l,s,a,!1,null,null,null);t["a"]=u.exports},"5adf":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e._l(e.displayDetails,(function(t,s){return["string"===t.type||"number"===t.type?i("b-form-group",{key:"genericField"+s,attrs:{label:e._f("startCase")(t.key),"label-for":"field.key",horizontal:""}},["string"===t.type?i("b-form-input",{ref:0===s?"focusInput":"",refInFor:!0,attrs:{name:t.key,placeholder:t.text,type:"text",autocomplete:t.key},model:{value:e.saveFields[t.key],callback:function(i){e.$set(e.saveFields,t.key,"string"===typeof i?i.trim():i)},expression:"saveFields[field.key]"}}):e._e(),"number"===t.type?i("b-form-input",{ref:0===s?"focusInput":"",refInFor:!0,attrs:{horizontal:"",name:t.key,type:"number",autocomplete:t.key},model:{value:e.saveFields[t.key],callback:function(i){e.$set(e.saveFields,t.key,e._n(i))},expression:"saveFields[field.key]"}}):e._e()],1):e._e(),"boolean"===t.type?i("b-form-group",{key:"genericField"+s},[i("div",{staticClass:"form-row"},[i("label",{staticClass:"col-form-label col-sm-3",attrs:{for:t.key}},[e._v(e._s(e._f("startCase")(t.key)))]),i("div",{staticClass:"mr-auto"},[i("toggle-button",{staticClass:"mt-2 p-0 fr-toggle-primary",attrs:{height:28,width:56,sync:!0,cssColors:!0},model:{value:e.saveFields[t.key],callback:function(i){e.$set(e.saveFields,t.key,i)},expression:"saveFields[field.key]"}})],1)])]):e._e()]})),i("b-button",{staticClass:"mt-4",attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$t("common.form.submit"))+" ")])],2)},a=[],n=i("2ef0"),r=i.n(n),o={name:"Generic-Self-Service",props:{selfServiceDetails:{required:!0}},data:function(){var e={},t=[];return this.selfServiceDetails&&this.selfServiceDetails.requirements&&this.selfServiceDetails.requirements.properties&&r.a.each(this.selfServiceDetails.requirements.properties,(function(i,s){t.push({type:i.type,text:i.description,key:s}),"string"===i.type?e[s]="":"boolean"===i.type?e[s]=!1:e[s]=null})),{saveFields:e,displayDetails:t}},methods:{getData:function(){return this.saveFields},save:function(){this.$emit("advanceStage",this.getData())},isValid:function(){return Promise.resolve(!0)}},filters:{startCase:function(e){return r.a.startCase(e)}}},l=o,c=i("2877"),u=Object(c["a"])(l,s,a,!1,null,"1e3745af",null);t["a"]=u.exports},"787a":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("button",{class:["btn btn-primary d-flex align-items-center",{disabled:e.loading}],attrs:{type:"button"},on:{click:function(t){return e.$emit("click")}}},[i("span",{class:[{"align-self-start":!e.large,"m-auto":e.large}]},[e._v(" "+e._s(e.label)+" ")]),i("span",{class:["fr-grow",{"fr-grow-in":e.loading}]},[i("transition",{attrs:{name:"fr-fade"}},[e.loading?i("clip-loader",{staticClass:"position-relative fr-clip-loader ml-3",attrs:{color:"white",size:"1rem"}}):e._e()],1)],1)])},a=[],n=i("8455"),r={name:"LoadingButton",components:{ClipLoader:n["ClipLoader"]},props:{label:String,loading:{type:Boolean,default:!1},large:{type:Boolean,default:!1}}},o=r,l=(i("20f7"),i("2877")),c=Object(l["a"])(o,s,a,!1,null,"18109016",null);t["a"]=c.exports},"9ce7":function(e,t,i){},ca3e:function(e,t,i){},d739:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("ValidationObserver",{ref:"observer",attrs:{slim:""}},e._l(e.answers,(function(t,s){return i("b-form-group",{key:s,staticClass:"mb-0",attrs:{"label-text-align":"left"}},[i("b-form-select",{staticClass:"mb-3",attrs:{options:e.options},model:{value:t.questionId,callback:function(i){e.$set(t,"questionId",i)},expression:"answer.questionId"}}),t.questionId===e.customIndex?i("fr-floating-label-input",{staticClass:"mb-3",attrs:{type:"text",fieldName:e.$t("common.user.kba.question").toLowerCase()+s,label:e.$t("common.user.kba.question"),validateRules:{required:!0,unique_question:e.getDuplicates(s)}},model:{value:t.customQuestion,callback:function(i){e.$set(t,"customQuestion","string"===typeof i?i.trim():i)},expression:"answer.customQuestion"}}):e._e(),i("fr-floating-label-input",{staticClass:"mb-3",attrs:{type:"text",fieldName:e.$t("common.user.kba.answer").toLowerCase()+s,label:e.$t("common.user.kba.answer"),validateRules:"required"},model:{value:t.answer,callback:function(i){e.$set(t,"answer","string"===typeof i?i.trim():i)},expression:"answer.answer"}}),s!==e.answers.length-1?i("hr"):e._e()],1)})),1)],1)},a=[],n=i("2ef0"),r=i.n(n),o=i("49c6"),l=i("7bb1"),c={name:"KBA-Definition-Form-Group",props:{selfServiceDetails:{required:!0},inline:{required:!1,default:!1}},components:{"fr-floating-label-input":o["a"]},data:function(){var e=this.selfServiceDetails.requirements.properties.kba,t=r.a.times(e.minItems,(function(){return{answer:null,questionId:null,customQuestion:null}})),i="custom";return{kba:e,answers:t,customIndex:i}},computed:{predefinedQuestionOptions:function(){var e=this;return r.a.map(this.kba.questions,(function(t){var i=t.id,s=t.question[e.$i18n.locale]||t.question[e.$i18n.fallbackLocale],a=!r.a.isUndefined(r.a.find(e.answers,{questionId:t.id}));return{value:i,text:s,disabled:a}}))},predefinedQuestionText:function(){return this.predefinedQuestionOptions.map((function(e){return e.text}))},options:function(){var e={value:null,text:this.$t("common.user.kba.selectQuestion"),disabled:!0},t={value:"custom",text:this.$t("common.user.kba.custom"),disabled:!1},i=[];return i=i.concat(e,this.predefinedQuestionOptions,t),i}},methods:{getData:function(){var e=this;return{kba:this.answers.map((function(t){return r.a.omit(t,t.questionId===e.customIndex?"questionId":"customQuestion")}))}},getDuplicates:function(e){return r.a.clone(this.answers).map((function(e){return e.customQuestion})).filter((function(t,i){return i!==e&&t})).concat(this.predefinedQuestionText)},isValid:function(){return this.$refs.observer.validate()}},created:function(){var e=this;Object(l["c"])("unique_question",{getMessage:function(t,i){return e.$t("common.user.kba.notUnique")},validate:function(e,t){var i=function(e){return r.a.trim(r.a.toLower(e))};return!r.a.includes(r.a.map(t,i),i(e))}})}},u=c,f=i("2877"),d=Object(f["a"])(u,s,a,!1,null,null,null);t["a"]=d.exports},d817:function(e,t,i){},dd4b:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"h-100"},[i("b-container",{directives:[{name:"show",rawName:"v-show",value:!e.showSelfService,expression:"!showSelfService"}],staticClass:"h-100 px-0",attrs:{fluid:""}},[i("div",{staticClass:"h-100 d-flex"},[i("div",{staticClass:"m-auto fr-center-card"},[i("bounce-loader",{attrs:{color:e.loadingColor}})],1)])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showSelfService,expression:"showSelfService"}]},["localAutoLogin"!==e.selfServiceType?i("fr-center-card",{attrs:{showLogo:!0}},[i("div",{attrs:{slot:"center-card-header"},slot:"center-card-header"},[i("h2",{directives:[{name:"show",rawName:"v-show",value:e.title.length>0,expression:"title.length > 0"}],staticClass:"h2"},[e._v(e._s(e.title))]),i("p",{directives:[{name:"show",rawName:"v-show",value:e.subtitle.length>0,expression:"subtitle.length > 0"}],staticClass:"text-center mb-0"},[e._v(e._s(e.subtitle))])]),i("b-card-body",{attrs:{slot:"center-card-body"},slot:"center-card-body"},[i(e.selfServiceType,{directives:[{name:"show",rawName:"v-show",value:e.showSelfService,expression:"showSelfService"}],ref:"selfServiceStage",tag:"component",attrs:{selfServiceDetails:e.selfServiceDetails},on:{advanceStage:e.advanceStage}})],1),i("b-card-footer",{attrs:{slot:"center-card-footer"},slot:"center-card-footer"},[e._v(" "+e._s(e.$t("pages.selfservice.registration.haveAccount"))+" "),i("router-link",{attrs:{action:"",to:{name:"Login"}}},[e._v(e._s(e.$t("pages.selfservice.registration.signIn")))])],1)],1):e._e()],1)],1)},a=[],n=i("2ef0"),r=i.n(n),o=i("8455"),l=i("b107"),c=i.n(l),u=i("13bf"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fr-all-in-one-container"},[e.stages.idmUserDetails?i("idmUserDetails",{attrs:{inline:!0,selfServiceDetails:e.selfServiceDetails}}):e._e(),e.stages.kbaSecurityAnswerDefinitionStage?i("kbaSecurityAnswerDefinitionStage",{attrs:{inline:!0,selfServiceDetails:e.selfServiceDetails}}):e._e(),e.stages.captcha?i("Captcha",{attrs:{"self-service-details":e.selfServiceDetails}}):e._e(),e.stages.consent&&e.selfServiceDetails.requirements&&e.selfServiceDetails.requirements.consent?[i("b-modal",{ref:"consentModal",attrs:{title:e.$t("pages.selfservice.registration.consent.title")},on:{hide:function(t){e.loading=!1}}},[i("Consent",{attrs:{inline:!0,selfServiceDetails:e.selfServiceDetails}}),i("b-form-checkbox",{attrs:{plain:"",value:!1,"unchecked-value":!0},model:{value:e.consentCheck,callback:function(t){e.consentCheck=t},expression:"consentCheck"}},[e._v(" "+e._s(e.$t("pages.selfservice.registration.consent.agreement"))+" ")]),i("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("b-btn",{staticClass:"float-right",attrs:{disabled:e.consentCheck,size:"sm",variant:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$t("common.form.okay"))+" ")])],1)],1)]:e._e(),i("fr-loading-button",{staticClass:"mt-2 mb-3 btn-lg btn-block",attrs:{type:"button",variant:"primary",label:e.$t("common.form.signUp"),loading:e.loading,large:!0},on:{click:e.saveCheck}}),e.stages.termsAndConditions&&e.selfServiceDetails.requirements&&e.selfServiceDetails.requirements.terms?i("TermsAndConditions",{attrs:{inline:!0,selfServiceDetails:e.selfServiceDetails}}):e._e()],2)},d=[],p=i("5aa8"),m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[!1===e.inline?i("h3",[e._v(e._s(e.$t("pages.selfservice.registration.consent.title")))]):e._e(),i("div",{staticClass:"d-block text-center"},[i("p",[e._v(e._s(e.selfServiceDetails.requirements.consent))])]),!1===e.inline?i("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$t("common.form.agree"))+" ")]):e._e()],1)},v=[],h={name:"Consent",props:{selfServiceDetails:{required:!0},inline:{required:!1,default:!1}},methods:{getData:function(){return{consentGiven:"true"}},save:function(){this.$emit("advanceStage",this.getData())},isValid:function(){return Promise.resolve(!0)}}},g=h,b=i("2877"),y=Object(b["a"])(g,m,v,!1,null,"1d2c556e",null),S=y.exports,_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ValidationObserver",{ref:"observer",attrs:{slim:""}},[i("b-form",[e.isSocialReg?e._e():i("fr-social-buttons",{attrs:{signin:!1}}),e._l(e.userDetails,(function(t,s){return i("b-form-group",{key:s,staticClass:"mb-0"},[i("fr-floating-label-input",{attrs:{defaultValue:t.socialValue,fieldName:s,label:t.description,validateRules:e.calculateValidation(t),type:"text"},model:{value:e.saveDetails[s],callback:function(t){e.$set(e.saveDetails,s,t)},expression:"saveDetails[key]"}})],1)})),e.isSocialReg?e._e():i("fr-password-policy-input",{attrs:{policyApi:"selfservice/registration",cols:1},model:{value:e.saveDetails.password,callback:function(t){e.$set(e.saveDetails,"password",t)},expression:"saveDetails.password"}}),i("div",{staticClass:"form-group mb-4"},e._l(e.userPreferences,(function(t,s){return i("div",{key:s,staticClass:"custom-control custom-checkbox mb-2"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.saveDetails.preferences[s],expression:"saveDetails.preferences[key]"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:s},domProps:{checked:Array.isArray(e.saveDetails.preferences[s])?e._i(e.saveDetails.preferences[s],null)>-1:e.saveDetails.preferences[s]},on:{change:function(t){var i=e.saveDetails.preferences[s],a=t.target,n=!!a.checked;if(Array.isArray(i)){var r=null,o=e._i(i,r);a.checked?o<0&&e.$set(e.saveDetails.preferences,s,i.concat([r])):o>-1&&e.$set(e.saveDetails.preferences,s,i.slice(0,o).concat(i.slice(o+1)))}else e.$set(e.saveDetails.preferences,s,n)}}}),i("label",{staticClass:"custom-control-label",attrs:{for:s}},[e._v(e._s(t.description))])])})),0),!1===e.inline?i("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$t("common.form.signUp"))+" ")]):e._e()],2)],1)},D=[],w=i("49c6"),k=i("f8f2"),C=i("3fd4"),$={name:"User-Details",components:{"fr-floating-label-input":w["a"],"fr-password-policy-input":k["a"],"fr-social-buttons":C["a"]},props:{selfServiceDetails:{required:!0},inline:{required:!1,default:!1}},data:function(){var e={userDetails:{},saveDetails:{},userPreferences:{},isSocialReg:"initial"!==r.a.get(this.selfServiceDetails,"tag")};return this.selfServiceDetails.requirements&&this.selfServiceDetails.requirements.registrationProperties&&(e.userDetails=this.selfServiceDetails.requirements.registrationProperties.properties,r.a.has(this.selfServiceDetails,"requirements.properties.user.default")&&!r.a.isUndefined(this.selfServiceDetails,"requirements.properties.user.default")&&r.a.each(this.selfServiceDetails.requirements.properties.user.default,(function(t,i){e.userDetails[i].socialValue=t})),r.a.each(this.selfServiceDetails.requirements.registrationProperties.required,(function(t){e.userDetails[t].required=!0})),r.a.each(this.selfServiceDetails.requirements.registrationProperties.properties,(function(t,i){e.saveDetails[i]=""}))),this.selfServiceDetails.requirements&&this.selfServiceDetails.requirements.registrationPreferences&&(e.saveDetails.preferences={},e.userPreferences=this.selfServiceDetails.requirements.registrationPreferences,r.a.each(e.userPreferences,(function(t,i){e.saveDetails.preferences[i]=!1}))),e.saveDetails.password="",e},methods:{getData:function(){var e=r.a.clone(this.saveDetails);return delete e.confirmPassword,this.isSocialReg&&delete e.password,{user:e}},calculateValidation:function(e){var t=[];return e.required&&t.push("required"),e.policies&&r.a.each(e.policies,(function(e){"valid-email-address-format"===e.policyId&&t.push("email")})),t.join("|")},save:function(){var e=this;this.isValid().then((function(t){t?e.$emit("advanceStage",e.getData()):e.displayNotification("error",e.$t("pages.selfservice.registration.pleaseComplete"))}))},isValid:function(){return this.$refs.observer.validate()}}},q=$,x=Object(b["a"])(q,_,D,!1,null,"f4d69062",null),P=x.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form",{staticClass:"mb-4",attrs:{id:"kbaDefinition"},on:{submit:function(e){e.preventDefault()}}},[e.inline?i("fr-horizontal-rule",{attrs:{insert:"<i class='fa fa-lock'></i>"}}):e._e(),i("p",{staticClass:"text-center"},[e._v(e._s(e.$t("common.user.kba.description")))]),i("fr-kba-form-group",{ref:"kbaFormGroup",attrs:{selfServiceDetails:e.selfServiceDetails}}),e.inline?e._e():i("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("pages.selfservice.registration.completeRegistration")))])],1)},A=[],R=i("d739"),I=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row"},[e._m(0),i("div",{staticClass:"col-auto pt-1",domProps:{innerHTML:e._s(e.insert)}},[e._v(e._s(e.insert))]),e._m(1)])},j=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"col pr-0"},[i("hr")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"col pl-0"},[i("hr")])}],E={name:"Horizontal-Rule",props:["insert"]},T=E,N=Object(b["a"])(T,I,j,!1,null,"b2625ffe",null),V=N.exports,M={name:"KBA-Security-Answer-Definition-Stage",props:{selfServiceDetails:{required:!0},inline:{required:!1,default:!1}},components:{"fr-horizontal-rule":V,"fr-kba-form-group":R["a"]},data:function(){return{}},methods:{getData:function(){return this.$refs.kbaFormGroup.getData()},save:function(){var e=this;this.isValid().then((function(t){t&&e.$emit("advanceStage",e.getData())}))},isValid:function(){return this.$refs.kbaFormGroup.isValid()}}},F=M,L=Object(b["a"])(F,O,A,!1,null,"31b1a8ac",null),U=L.exports,B=i("787a"),Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.inline?i("div",[i("small",{staticClass:"form-text text-muted"},[e._v(" "+e._s(e.$t("pages.selfservice.registration.termsAndConditions.singlePage"))+" "),i("a",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"termsModal",expression:"'termsModal'"}],attrs:{href:"#"},on:{click:function(e){e.preventDefault()}}},[e._v(e._s(e.$t("pages.selfservice.registration.termsAndConditions.title")))]),e._v(". ")]),i("b-modal",{attrs:{id:"termsModal","hide-footer":"",title:e.$t("pages.selfservice.registration.termsAndConditions.title")}},[i("div",{staticClass:"d-block text-center"},[i("p",{domProps:{innerHTML:e._s(e.selfServiceDetails.requirements.terms)}},[e._v(e._s(e.selfServiceDetails.requirements.terms))])])])],1):i("div",[i("h3",[e._v(e._s(e.$t("pages.selfservice.registration.termsAndConditions.title")))]),i("div",{staticClass:"d-block text-center"},[i("p",{domProps:{innerHTML:e._s(e.selfServiceDetails.requirements.terms)}},[e._v(e._s(e.selfServiceDetails.requirements.terms))])]),!1===e.inline?i("b-button",{attrs:{block:!0,size:"lg",variant:"primary"},on:{click:e.save}},[e._v(" "+e._s(e.$t("common.form.agree"))+" ")]):e._e()],1)},z=[],H={name:"Terms-And-Conditions",props:{selfServiceDetails:{required:!0},inline:{required:!1,default:!1}},methods:{getData:function(){return{accept:"true"}},save:function(){this.$emit("advanceStage",this.getData())},isValid:function(){return Promise.resolve(!0)}}},G=H,X=Object(b["a"])(G,Q,z,!1,null,"ec48583a",null),K=X.exports,J={name:"All-In-One-Registration",props:{selfServiceDetails:{required:!0}},components:{idmUserDetails:P,kbaSecurityAnswerDefinitionStage:U,TermsAndConditions:K,Consent:S,Captcha:p["a"],"fr-loading-button":B["a"]},data:function(){var e={stages:{},consentCheck:!0,loading:!1};return r.a.each(this.selfServiceDetails.requirements.stages,(function(t){e.stages[t]=!0})),e},methods:{getData:function(){var e={};return r.a.each(this.$children,(function(t){var i={};t.getData&&(i=t.getData()),e=r.a.merge(e,i)})),this.selfServiceDetails.requirements.consentEnabled&&(e.consentGiven="true"),e},saveCheck:function(){var e=this;this.loading=!0,this.selfServiceDetails.requirements.consentEnabled?this.isValid().then((function(){e.$refs.consentModal.show()})):this.isValid().then((function(){e.save()}))},save:function(){this.$emit("advanceStage",this.getData()),this.loading=!1},isValid:function(){var e=this,t=[],i=new Promise((function(i,s){e.$children&&r.a.each(e.$children,(function(i,s){e.$children[s].isValid&&t.push(e.$children[s].isValid())})),Promise.all(t).then((function(t){var s=!0;r.a.each(t,(function(e){!1===e&&(s=!1)})),s?i({success:!0}):(e.displayNotification("error",e.$t("pages.selfservice.registration.pleaseComplete")),e.loading=!1)}))}));return i}}},W=J,Y=Object(b["a"])(W,f,d,!1,null,"d4ee1516",null),Z=Y.exports,ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-alert",{attrs:{show:""}},[e._v(" "+e._s(e.$t("pages.selfservice.registration.emailValidation"))+" ")])},te=[],ie={name:"Email-Validation"},se=ie,ae=Object(b["a"])(se,ee,te,!1,null,null,null),ne=ae.exports,re=i("5adf"),oe=i("e5d2"),le=["captcha","consent","emailValidation","kbaSecurityAnswerDefinitionStage","termsAndConditions"],ce={name:"Registration",components:{"fr-center-card":u["a"],AllInOneRegistration:Z,BounceLoader:o["BounceLoader"],Captcha:p["a"],Consent:S,emailValidation:ne,idmUserDetails:P,kbaSecurityAnswerDefinitionStage:U,TermsAndConditions:K,GenericSelfService:re["a"]},props:["clientToken"],mixins:[oe["a"]],data:function(){return{selfServiceType:null,selfServiceDetails:null,loadingColor:c.a.baseColor,showSelfService:!1,apiType:"registration",clientTokenUsed:!1}},computed:{title:function(){return r.a.includes(le,this.selfServiceType)?this.$t("pages.selfservice.registration.stageTitle.".concat(this.selfServiceType)):this.$t("pages.selfservice.registration.signUp")},subtitle:function(){return r.a.includes(le,this.selfServiceType)?this.$t("pages.selfservice.registration.stageSubtitle.".concat(this.selfServiceType)):this.$t("pages.selfservice.registration.signUpMsg")}},mounted:function(){this.$route.params.queryParams?(this.selfServiceType="localAutoLogin",this.advanceStage(this.parseQueryParams(this.$route.params.queryParams))):this.loadData()},methods:{setChildComponent:function(e,t){var i=this;if(this.selfServiceDetails=t,"parameters"===e)this.selfServiceType=null,this.showSelfService=!1,this.advanceStage({input:{}});else if(this.clientToken&&!this.clientTokenUsed)this.advanceStage({clientToken:this.clientToken,oauthRegister:"true"}),this.clientTokenUsed=!0;else if("localAutoLogin"===t.type)if(r.a.has(t,"additions.oauthLogin")&&t.additions.oauthLogin){var s=this.getRequestService({headers:{"X-OpenIDM-NoSession":"false","X-OpenIDM-OAuth-Login":"true","X-OpenIDM-DataStoreToken":this.clientToken,"X-Requested-With":"XMLHttpRequest"}});s.post("/authentication?_action=login").then((function(e){i.displayNotification("success",i.$t("pages.selfservice.registration.createdAccount")),t.additions.successUrl&&t.additions.successUrl.length>0?window.location=t.additions.successUrl:i.progressiveProfileCheck(e,(function(){window.history.pushState("","",window.location.pathname),i.$router.push("/")}))})).catch((function(){window.history.pushState("","",window.location.pathname),i.$router.push("/login")}))}else this.autoLogin(t.additions.credentialJwt,t.additions.successUrl);else{var a=!1;r.a.each(this.$options.components,(function(t,i){r.a.toLower(i)===r.a.toLower(e)&&(a=!0)})),this.selfServiceType=a?e:"GenericSelfService",this.showSelfService=!0}},apiErrorCallback:function(e){var t=this.findPolicyError(e.response);this.showSelfService=!0,this.displayNotification("error",t)},findPolicyError:function(e){var t=e.data.message,i="";if(r.a.has(e,"data.detail.failedPolicyRequirements")){var s=e.data.detail.failedPolicyRequirements[0];s.policyRequirements.length>0&&(i=this.$t("common.policyValidationMessages.".concat(s.policyRequirements[0].policyRequirement),s.policyRequirements[0].params),t="".concat(this.$t("common.policyValidationMessages.policyValidationFailed",{property:s.property}),": ").concat(i))}return t},autoLogin:function(e,t){var i=this,s=this.getRequestService({headers:{"X-OpenIDM-Jwt":e,"X-OpenIDM-NoSession":!1,"X-OpenIDM-Password":null,"X-OpenIDM-Username":null}}),a=this.getRequestService({headers:this.getAnonymousHeaders()});a.post("/authentication?_action=logout").then((function(){s.post("/authentication?_action=login").then((function(e){i.displayNotification("success",i.$t("pages.selfservice.registration.createdAccount")),t&&t.length>0?window.location=t:i.progressiveProfileCheck(e,(function(){i.$router.push("/")}))})).catch((function(e){i.displayNotification("error",e.response.data.message)}))}))}}},ue=ce,fe=Object(b["a"])(ue,s,a,!1,null,null,null);t["default"]=fe.exports},f8f2:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-form-group",{staticClass:"mb-0"},[e._t("input",[i("fr-floating-label-input",{attrs:{name:"password",fieldName:"password",type:"password",label:e.label||e.$t("common.placeholders.password"),reveal:!0,showErrorState:!1},on:{input:function(t){return e.setFailingPolicies(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})]),e._t("policy-panel",[i("fr-policy-panel",{staticClass:"mt-2",attrs:{"num-columns":e.cols,policies:e.policies,"policy-failures":e.failedPolicies}})])],2)},a=[],n=i("2ef0"),r=i("49c6"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-row",e._l(e.numColumns,(function(t){return i("b-col",{key:"password_policy_"+t},[i("small",[i("ul",{staticClass:"pl-4 text-left"},e._l(e.policyColumns[t-1],(function(t){return i("li",{key:t.policyId,class:[{"fr-valid":!e.includes(e.policyFailures,t.name)},"text-muted fr-policy-list-item"]},[e._v(" "+e._s(e.$t("common.policyValidationMessages."+t.name,t.params))+" ")])})),0)])])})),1)},l=[],c={name:"PolicyPanel",props:{numColumns:{type:Number,default:1},policies:{type:Array,default:function(){return[]}},policyFailures:{type:Array,default:function(){return[]}}},data:function(){return{policyColumns:[]}},computed:{numPolicies:function(){return this.policies.length}},methods:{includes:n["includes"],getPolicyColumns:function(e,t){var i=[],s=e.length,a=Math.floor(s/t),n=s%t,r=0;return e.forEach((function(e){"undefined"===typeof i[r]&&i.push([]),i[r].push({name:e.name,params:e.params});var t=r<n?a+1:a;i[r].length>=t&&(r+=1)})),i}},watch:{policies:{handler:function(e){this.policyColumns=this.getPolicyColumns(e,this.numColumns)},immediate:!0}}},u=c,f=(i("f989"),i("2877")),d=Object(f["a"])(u,o,l,!1,null,"48905e4d",null),p=d.exports,m={name:"PolicyPasswordInput",components:{"fr-floating-label-input":r["a"],"fr-policy-panel":p},props:{excludeOverwrite:{required:!1,type:Array,default:null},cols:{type:Number,default:2},failed:{type:Array,default:function(){return[]}},userPolicyObject:{type:Boolean,default:!1},label:{type:String,default:function(){return this.$t("common.placeholders.password")}},policyApi:{required:!0,type:String},value:{type:[String,Object],default:function(){return""}}},data:function(){return{failedPolicies:[],password:this.value,policies:[],policyService:function(){},serverFailures:[]}},watch:{failed:{handler:function(e){this.serverFailures=this.getFailedPolicyMessages(e)},deep:!0,immediate:!0},failedPolicies:function(e){this.$emit("valid",0===e.length)},password:function(e){this.$emit("input",e)},value:function(){this.password=this.value}},computed:{exclude:function(){return this.excludeOverwrite?this.excludeOverwrite:[{name:"REQUIRED",predicate:function(e){return Object(n["includes"])(e,"REQUIRED")&&Object(n["includes"])(e,"MIN_LENGTH")}},{name:"IS_NEW",predicate:function(){return"selfservice/registration"===this.policyApi}},"VALID_TYPE","CANNOT_CONTAIN_OTHERS"]}},methods:{isPasswordPolicyItem:Object(n["curry"])((function(e,t){return!Object(n["isEmpty"])(t[e].match("password"))})),toSimplePolicyObject:function(e){var t=e.policyRequirements,i=e.params,s=Object(n["first"])(t);return Object(n["isUndefined"])(s)?{}:{name:s,params:i}},toPolicyNames:function(e){var t=e.failedPolicyRequirements||[],i=t.filter(this.isPasswordPolicyItem("property")).map((function(e){return Object(n["at"])(e,["policyRequirements[0].policyRequirement"])}));return Object(n["flatten"])(i)},makeExclusions:function(e,t){var i=e&&e.policyRequirements?e.policyRequirements:[],s=e&&e.policies?e.policies:[],a=function(e){return Object(n["reject"])(s,(function(t){return Object(n["first"])(t.policyRequirements)===e}))};return t.forEach((function(e){Object(n["isObject"])(e)?e.predicate(i)&&(s=a(e.name)):Object(n["isString"])(e)&&Object(n["includes"])(i,e)&&(s=a(e))})),Object.assign({},e,{policyRequirements:i,policies:s})},getFailedPolicyMessages:function(e){var t=this;return 0===e.length?[]:this.failed.map((function(e){var i=e.policyRequirements[0].policyRequirement,s=e.policyRequirements[0].params;return t.$t("common.policyValidationMessages.".concat(i),s)}))},setFailingPolicies:Object(n["debounce"])((function(e){var t=this,i={password:e};this.policyApi.match("registration")&&(i={user:{password:this.password}}),this.policyService.post("/policy/".concat(this.policyApi,"/?_action=validateObject"),i).then((function(e){var i=e.data;t.failedPolicies=t.toPolicyNames(i),t.serverFailures=[]})).catch((function(){t.displayNotification("IDMMessages","error",t.$t("common.policyValidationMessages.policyServiceError.policyApi",{policyApi:t.policyApi}))}))}),200)},created:function(){var e=this,t=this.getAnonymousHeaders();this.policyService=this.getRequestService({headers:t}),this.policyService.get("/policy/".concat(this.policyApi)).then((function(t){var i=t.data;return Object(n["head"])(i.properties.filter(e.isPasswordPolicyItem("name")))})).then((function(t){return e.makeExclusions(t,e.exclude)})).then((function(t){var i=t.policies;e.policies=i.map(e.toSimplePolicyObject).filter((function(e){return!Object(n["isEmpty"])(e)}))})).catch((function(){e.displayNotification("IDMMessages","error",e.$t("common.policyValidationMessages.policyServiceError.policyApi",{policyApi:e.policyApi})),e.$router.push("/login")})),this.setFailingPolicies(this.password)}},v=m,h=Object(f["a"])(v,s,a,!1,null,null,null);t["a"]=h.exports},f970:function(e,t,i){"use strict";var s=i("9ce7"),a=i.n(s);a.a},f989:function(e,t,i){"use strict";var s=i("d817"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-4534466e.ed3f99d9.js.map